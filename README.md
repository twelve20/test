# Интеграция сайта с Telegram ботом

Этот проект содержит реализацию отправки заявок с форм сайта в Telegram через бота. Включает как клиентскую, так и серверную части.

## Настройка Telegram бота

### Шаг 1: Создание бота

1. Откройте Telegram и найдите бота @BotFather
2. Отправьте команду `/newbot`
3. Укажите имя бота (например, "Мой Магазин Бот")
4. Придумайте и введите уникальное имя пользователя для бота, которое должно заканчиваться на "bot" (например, "myshop_bot")
5. BotFather пришлет вам токен бота - сохраните его, он понадобится для настройки

### Шаг 2: Получение Chat ID

Вам необходимо узнать ID чата, куда будут поступать уведомления:

#### Способ 1: Через бота @userinfobot
1. Найдите бота @userinfobot
2. Отправьте ему сообщение
3. Бот пришлет вам информацию о вашем аккаунте, включая ID

#### Способ 2: Через API запрос
1. Откройте ваш новый бот в чате
2. Отправьте ему сообщение
3. Перейдите в браузере по ссылке:
   ```
   https://api.telegram.org/bot<ВАШ_ТОКЕН>/getUpdates
   ```
   (замените `<ВАШ_ТОКЕН>` на полученный от BotFather токен)
4. В ответе найдите значение "chat":{"id": число} - это и есть ваш Chat ID

## Установка и настройка

### Клиентская часть (Frontend)

Клиентская часть не требует особой установки - просто разместите файлы сайта на вашем хостинге.

### Серверная часть (Backend)

1. Убедитесь, что у вас установлен [Node.js](https://nodejs.org/) (рекомендуется версия 14+)

2. Клонируйте репозиторий или скачайте файлы проекта

3. Установите зависимости:
   ```bash
   npm install
   ```

4. Настройте переменные окружения:
   - Переименуйте файл `.env.example` в `.env` (если он существует)
   - Отредактируйте файл `.env`, указав ваш токен бота и ID чата:
     ```
     BOT_TOKEN=ваш_токен_бота
     CHAT_ID=ваш_chat_id
     PORT=3000  # По желанию можно изменить порт
     ```

5. Запустите сервер:
   ```bash
   npm start
   ```
   
   Для разработки с автоматической перезагрузкой:
   ```bash
   npm run dev
   ```

6. Сервер будет доступен по адресу: http://localhost:3000

## Структура проекта

- `index.html` - главная страница сайта
- `style.css` - стили сайта
- `script.js` - клиентский JavaScript, обрабатывающий формы
- `server.js` - серверная часть (Node.js) для отправки сообщений в Telegram
- `.env` - файл с переменными окружения (токен бота и ID чата)
- `package.json` - конфигурация Node.js проекта и зависимости

## Как это работает

1. Пользователь заполняет форму на сайте
2. При отправке формы, данные отправляются на серверный API
3. Сервер обрабатывает данные и отправляет их в Telegram через Bot API
4. Владелец сайта получает уведомление с деталями заявки в Telegram

## Настройка для продакшена

### Вариант 1: Совместное размещение клиентской и серверной части

Если вы размещаете и клиентские и серверные файлы вместе:

1. Загрузите все файлы на ваш хостинг с поддержкой Node.js
2. Настройте переменные окружения
3. Установите зависимости и запустите сервер

### Вариант 2: Раздельное размещение

1. Разместите клиентские файлы (HTML, CSS, JS) на статическом хостинге
2. Разместите серверную часть на хостинге с поддержкой Node.js
3. Обновите URL API в файле `script.js`:
   ```javascript
   const apiUrl = 'https://ваш-сервер.com/send-to-telegram';
   ```

## Советы и решение проблем

1. **CORS-ошибки**: Если вы получаете ошибки CORS, убедитесь, что серверная часть настроена для доступа с вашего домена. Можно изменить настройки CORS в `server.js`.

2. **Безопасность**: В текущей реализации токен бота хранится на сервере, что значительно безопаснее, чем хранение его в клиентском коде.

3. **Ограничения API**: Обратите внимание на ограничения Telegram Bot API - не более 30 сообщений в секунду в один чат и не более 20 сообщений в минуту в группы.

4. **Форматирование сообщений**: Telegram поддерживает HTML и Markdown разметку, что позволяет форматировать сообщения. В нашем примере мы используем HTML формат.

## Дополнительные возможности

- Настройка уведомлений в групповой чат
- Добавление кнопок в сообщения бота
- Отправка файлов и изображений
- Создание Webhook вместо getUpdates для обработки сообщений от пользователей 